<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIT Executive Pipeline Report</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: #f8fafc; 
            color: #1e293b; 
            line-height: 1.5;
            padding: 20px;
        }
        .report-container { max-width: 1000px; margin: 0 auto; background: white; }
        
        /* Header */
        .header { 
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); 
            color: white; 
            padding: 30px 40px; 
            text-align: center;
        }
        .header h1 { font-size: 28px; font-weight: 700; margin-bottom: 8px; }
        .header .timestamp { font-size: 14px; opacity: 0.9; }
        
        /* KPI Grid - 5 boxes */
        .kpi-grid { 
            display: grid; 
            grid-template-columns: repeat(5, 1fr); 
            gap: 0; 
            border-bottom: 3px solid #e2e8f0;
        }
        .kpi-box { 
            padding: 20px 15px; 
            text-align: center; 
            border-right: 1px solid #e2e8f0;
            background: white;
        }
        .kpi-box:last-child { border-right: none; }
        .kpi-label { font-size: 11px; color: #64748b; text-transform: uppercase; font-weight: 600; margin-bottom: 8px; }
        .kpi-value { font-size: 36px; font-weight: 700; color: #1e3a5f; }
        .kpi-value.critical { color: #dc2626; }
        .kpi-value.warning { color: #f59e0b; }
        .kpi-value.success { color: #059669; }
        .kpi-sublabel { font-size: 10px; color: #94a3b8; margin-top: 4px; }
        
        /* Sections */
        .section { padding: 25px 40px; border-bottom: 1px solid #e2e8f0; }
        .section:last-child { border-bottom: none; }
        .section h2 { 
            font-size: 16px; 
            color: #1e3a5f; 
            margin-bottom: 15px; 
            padding-bottom: 8px; 
            border-bottom: 2px solid #e2e8f0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .section h3 { font-size: 14px; color: #475569; margin: 20px 0 10px 0; }
        
        /* Priority Section - subtle styling */
        .priority-section { background: white; border-left: 4px solid #dc2626; }
        .priority-section h2 { color: #dc2626; border-bottom-color: #e2e8f0; }
        
        .ready-section { background: white; border-left: 4px solid #059669; }
        .ready-section h2 { color: #059669; border-bottom-color: #e2e8f0; }
        
        .new-section { background: white; border-left: 4px solid #3b82f6; }
        .new-section h2 { color: #3b82f6; border-bottom-color: #e2e8f0; }
        
        /* Tables */
        table { width: 100%; border-collapse: collapse; font-size: 12px; margin-top: 10px; }
        th { 
            background: #f1f5f9; 
            color: #475569; 
            font-weight: 600; 
            text-transform: uppercase; 
            font-size: 10px; 
            padding: 10px 12px; 
            text-align: left;
            border-bottom: 2px solid #e2e8f0;
        }
        td { padding: 10px 12px; border-bottom: 1px solid #f1f5f9; }
        tr:hover { background: #f8fafc; }
        
        /* Status badges */
        .status-badge { 
            display: inline-block; 
            padding: 3px 8px; 
            border-radius: 12px; 
            font-size: 10px; 
            font-weight: 600; 
        }
        .status-strong { background: #dcfce7; color: #166534; }
        .status-ontrack { background: #fef3c7; color: #92400e; }  /* Changed to yellow */
        .status-monitor { background: #fef3c7; color: #92400e; }
        .status-pending { background: #f1f5f9; color: #64748b; }
        
        /* Score display */
        .score { font-weight: 600; }
        .score-high { color: #059669; }
        .score-mid { color: #f59e0b; }
        .score-low { color: #dc2626; }
        
        /* Observation box */
        .observation { 
            background: #f8fafc; 
            padding: 10px 12px; 
            border-radius: 6px; 
            font-size: 11px; 
            color: #64748b; 
            margin-top: 8px;
            font-style: italic;
        }
        
        /* MIT Card for critical/ready sections */
        .mit-card { 
            background: white; 
            border: 1px solid #e2e8f0; 
            border-radius: 8px; 
            padding: 15px; 
            margin-bottom: 12px;
        }
        .mit-card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .mit-card-name { font-weight: 600; color: #1e293b; font-size: 14px; }
        .mit-card-meta { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; font-size: 11px; }
        .mit-card-meta-item label { color: #94a3b8; display: block; font-size: 9px; text-transform: uppercase; }
        .mit-card-meta-item span { color: #334155; font-weight: 500; }
        
        /* Insights */
        .insights-list { list-style: none; }
        .insights-list li { 
            padding: 10px 15px; 
            margin-bottom: 8px; 
            background: #f8fafc; 
            border-radius: 6px;
            font-size: 13px;
            border-left: 3px solid #cbd5e1;
        }
        .insights-list li:nth-child(1) { border-left-color: #dc2626; }
        .insights-list li:nth-child(2) { border-left-color: #f59e0b; }
        .insights-list li:nth-child(3) { border-left-color: #3b82f6; }
        
        /* Mock QBR Schedule */
        .qbr-schedule { display: flex; gap: 15px; flex-wrap: wrap; }
        .qbr-item { 
            background: #fefce8; 
            border: 1px solid #fde047; 
            padding: 10px 15px; 
            border-radius: 6px; 
            font-size: 12px;
        }
        .qbr-item strong { color: #854d0e; }
        
        /* Meeting insights */
        .meeting-insights { columns: 2; column-gap: 30px; }
        .meeting-insights li { 
            padding: 6px 0; 
            border-bottom: 1px solid #f1f5f9; 
            font-size: 12px;
            break-inside: avoid;
        }
        
        /* Footer */
        .footer { 
            background: #f8fafc; 
            padding: 20px 40px; 
            text-align: center; 
            font-size: 11px; 
            color: #64748b;
        }
        .footer a { color: #3b82f6; }
        
        /* Print styles */
        @media print {
            body { padding: 0; background: white; }
            .report-container { max-width: none; }
            .header { padding: 20px 30px; }
            .header h1 { font-size: 22px; }
            .section { padding: 15px 30px; }
            .kpi-value { font-size: 28px; }
            .mit-card { page-break-inside: avoid; }
            .priority-section, .ready-section, .new-section { 
                -webkit-print-color-adjust: exact !important; 
                print-color-adjust: exact !important; 
            }
        }
    </style>
</head>
<body>
    <div class="report-container">
        <!-- Header -->
        <div class="header">
            <h1>MIT Executive Pipeline Report</h1>
            <p class="timestamp">Generated: {{ timestamp }}</p>
        </div>

        <!-- KPI Grid - 5 Boxes -->
            <div class="kpi-grid">
                <div class="kpi-box">
                    <div class="kpi-label">Active MITs</div>
                <div class="kpi-value">{{ active_mits }}</div>
                <div class="kpi-sublabel">Total Pipeline</div>
                    </div>
            <div class="kpi-box">
                <div class="kpi-label">New Starts</div>
                <div class="kpi-value success">{{ band_counts.new_starts }}</div>
                <div class="kpi-sublabel">Weeks 0-3</div>
                </div>
                <div class="kpi-box">
                <div class="kpi-label">Mid-Training</div>
                <div class="kpi-value">{{ band_counts.mid_training }}</div>
                <div class="kpi-sublabel">Weeks 4-5</div>
                </div>
                <div class="kpi-box">
                <div class="kpi-label">Critical Window</div>
                <div class="kpi-value critical">{{ band_counts.critical_window }}</div>
                <div class="kpi-sublabel">Weeks 6-7</div>
                </div>
                <div class="kpi-box">
                <div class="kpi-label">Placement Ready</div>
                <div class="kpi-value warning">{{ band_counts.placement_ready }}</div>
                <div class="kpi-sublabel">Week 8+</div>
            </div>
        </div>

        <!-- CRITICAL WINDOW SECTION -->
        {% if mits_by_week_band.weeks_6_7 %}
        <div class="section priority-section">
            <h2>üö® Critical Window ‚Äî Immediate Placement Attention (Weeks 6-7)</h2>
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Week</th>
                        <th>Location</th>
                        <th>Primary Score</th>
                        <th>Other Scores</th>
                        <th>Mock QBR</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for mit in mits_by_week_band.weeks_6_7 %}
                    {% set has_other_scores = (mit.assessment_score and mit.assessment_score > 0) or (mit.perf_eval_score and mit.perf_eval_score > 0) or (mit.confidence_score and mit.confidence_score > 0) %}
                    <tr>
                        <td><strong>{{ mit.name }}</strong></td>
                        <td>{{ mit.week }}</td>
                        <td>{{ mit.location }}</td>
                        <td class="score {% if mit.primary_score_type == 'Skill Ranking' %}{% if 'low' in mit.skill_ranking.lower() %}score-low{% elif 'mid' in mit.skill_ranking.lower() %}score-mid{% else %}score-high{% endif %}{% elif mit.mentor_score and mit.mentor_score >= 4.0 %}score-high{% elif mit.mentor_score and mit.mentor_score >= 3.0 %}score-mid{% elif mit.mentor_score %}score-low{% endif %}">
                            {% if mit.primary_score_type == 'Skill Ranking' %}
                                <div style="font-size: 10pt; color: #64748b; font-weight: 400;">{{ mit.primary_score_type }}:</div>
                                <div style="font-weight: 600; {% if 'low' in mit.skill_ranking.lower() %}color: #ef4444;{% elif 'mid' in mit.skill_ranking.lower() %}color: #f59e0b;{% else %}color: #10b981;{% endif %}">
                                    {{ mit.skill_ranking }}
                                </div>
                            {% else %}
                                <div style="font-size: 10pt; color: #64748b; font-weight: 400;">{{ mit.primary_score_type }}:</div>
                                <div style="font-weight: 600; {% if mit.mentor_score and mit.mentor_score >= 4.0 %}color: #10b981;{% elif mit.mentor_score and mit.mentor_score >= 3.0 %}color: #f59e0b;{% elif mit.mentor_score %}color: #ef4444;{% else %}color: #64748b;{% endif %}">
                                    {% if mit.mentor_score %}{{ "%.1f"|format(mit.mentor_score) }}/5{% else %}Pending{% endif %}
                                </div>
                            {% endif %}
                        </td>
                        <td style="font-size: 10pt; color: #64748b;">
                            {% if has_other_scores %}
                                {% if mit.assessment_score and mit.assessment_score > 0 %}
                                    <div>Assessment: {{ "%.0f"|format(mit.assessment_score) }}/100</div>
                                {% endif %}
                                {% if mit.perf_eval_score and mit.perf_eval_score > 0 %}
                                    <div>Perf Eval: {{ "%.0f"|format(mit.perf_eval_score) }}/60</div>
                                {% endif %}
                                {% if mit.confidence_score and mit.confidence_score > 0 %}
                                    <div>Confidence: {{ "%.0f"|format(mit.confidence_score) }}/100</div>
                                {% endif %}
                            {% else %}
                                <span style="color: #94a3b8;">‚Äî</span>
                            {% endif %}
                        </td>
                        <td>{% if mit.mock_qbr_date and mit.mock_qbr_date != 'nan' %}{{ mit.mock_qbr_date }}{% else %}TBD{% endif %}</td>
                        <td>
                            <span class="status-badge {% if mit.readiness_status == 'Strong' %}status-strong{% elif mit.readiness_status == 'On Track' %}status-ontrack{% elif mit.readiness_status == 'Monitor' %}status-monitor{% else %}status-pending{% endif %}">
                                {{ mit.readiness_status }}
                            </span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
            {% endif %}

        <!-- PLACEMENT READY SECTION -->
        {% if mits_by_week_band.weeks_8_plus %}
        <div class="section ready-section">
            <h2>‚úÖ Placement Ready ‚Äî Awaiting Assignment (Week 8+)</h2>
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Week</th>
                        <th>Vertical</th>
                        <th>Primary Score</th>
                        <th>Other Scores</th>
                        <th>Mock QBR</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for mit in mits_by_week_band.weeks_8_plus %}
                    {% set has_other_scores = (mit.assessment_score and mit.assessment_score > 0) or (mit.perf_eval_score and mit.perf_eval_score > 0) or (mit.confidence_score and mit.confidence_score > 0) %}
                    <tr>
                        <td><strong>{{ mit.name }}</strong></td>
                        <td>{% if mit.week >= 12 %}<span style="color: #dc2626; font-weight: 600;">{{ mit.week }} ‚ö†Ô∏è</span>{% else %}{{ mit.week }}{% endif %}</td>
                        <td>{{ mit.vertical }}</td>
                        <td class="score {% if mit.primary_score_type == 'Skill Ranking' %}{% if 'low' in mit.skill_ranking.lower() %}score-low{% elif 'mid' in mit.skill_ranking.lower() %}score-mid{% else %}score-high{% endif %}{% elif mit.mentor_score and mit.mentor_score >= 4.0 %}score-high{% elif mit.mentor_score and mit.mentor_score >= 3.0 %}score-mid{% elif mit.mentor_score %}score-low{% endif %}">
                            {% if mit.primary_score_type == 'Skill Ranking' %}
                                <div style="font-size: 10pt; color: #64748b; font-weight: 400;">{{ mit.primary_score_type }}:</div>
                                <div style="font-weight: 600; {% if 'low' in mit.skill_ranking.lower() %}color: #ef4444;{% elif 'mid' in mit.skill_ranking.lower() %}color: #f59e0b;{% else %}color: #10b981;{% endif %}">
                                    {{ mit.skill_ranking }}
                                </div>
                            {% else %}
                                <div style="font-size: 10pt; color: #64748b; font-weight: 400;">{{ mit.primary_score_type }}:</div>
                                <div style="font-weight: 600; {% if mit.mentor_score and mit.mentor_score >= 4.0 %}color: #10b981;{% elif mit.mentor_score and mit.mentor_score >= 3.0 %}color: #f59e0b;{% elif mit.mentor_score %}color: #ef4444;{% else %}color: #64748b;{% endif %}">
                                    {% if mit.mentor_score %}{{ "%.1f"|format(mit.mentor_score) }}/5{% else %}‚Äî{% endif %}
                                </div>
                            {% endif %}
                        </td>
                        <td style="font-size: 10pt; color: #64748b;">
                            {% if has_other_scores %}
                                {% if mit.assessment_score and mit.assessment_score > 0 %}
                                    <div>Assessment: {{ "%.0f"|format(mit.assessment_score) }}/100</div>
                                {% endif %}
                                {% if mit.perf_eval_score and mit.perf_eval_score > 0 %}
                                    <div>Perf Eval: {{ "%.0f"|format(mit.perf_eval_score) }}/60</div>
                                {% endif %}
                                {% if mit.confidence_score and mit.confidence_score > 0 %}
                                    <div>Confidence: {{ "%.0f"|format(mit.confidence_score) }}/100</div>
                                {% endif %}
                            {% else %}
                                <span style="color: #94a3b8;">‚Äî</span>
                            {% endif %}
                        </td>
                        <td>{% if mit.mock_qbr_score %}{{ mit.mock_qbr_score }}/4 ‚úì{% elif mit.mock_qbr_date and mit.mock_qbr_date != 'nan' %}{{ mit.mock_qbr_date }}{% else %}Pending{% endif %}</td>
                        <td>
                            <span class="status-badge {% if mit.readiness_status == 'Strong' %}status-strong{% elif mit.readiness_status == 'On Track' %}status-ontrack{% elif mit.readiness_status == 'Monitor' %}status-monitor{% else %}status-pending{% endif %}">
                                {{ mit.readiness_status }}
                            </span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
            {% endif %}

        <!-- NEW STARTS SECTION -->
        {% if mits_by_week_band.weeks_0_3 %}
        <div class="section new-section">
            <h2>üå± New Starts ‚Äî Onboarding Progress (Weeks 0-3)</h2>
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Week</th>
                        <th>Location</th>
                        <th>Mentor</th>
                        <th>First Survey</th>
                        <th>OIG Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for mit in mits_by_week_band.weeks_0_3 %}
                    <tr>
                        <td><strong>{{ mit.name }}</strong></td>
                        <td>{{ mit.week }}</td>
                        <td>{{ mit.location }}</td>
                        <td>{{ mit.mentor }}</td>
                        <td>
                            {% if mit.first_survey_submitted %}
                                <span style="color: #059669;">‚úì {{ "%.1f"|format(mit.mentor_score) }}/5</span>
                            {% else %}
                                <span style="color: #94a3b8;">Pending</span>
                            {% endif %}
                        </td>
                        <td>{{ mit.oig_status }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
            {% endif %}

        <!-- PENDING MITS SECTION -->
        {% if mits_by_week_band.pending_mits %}
        <div class="section" style="background: #fef3c7; border-left: 4px solid #f59e0b;">
            <h2>‚è≥ Incoming MITs ‚Äî Pending Start</h2>
            <p style="font-size: 12px; color: #92400e; margin-bottom: 15px;">MITs who have accepted offers but have not yet started training.</p>
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Location</th>
                        <th>Vertical</th>
                        <th>Mentor</th>
                        <th>Expected Start</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for mit in mits_by_week_band.pending_mits %}
                    <tr>
                        <td><strong>{{ mit.name }}</strong></td>
                        <td>{{ mit.location }}</td>
                        <td>{{ mit.vertical }}</td>
                        <td>{{ mit.mentor }}</td>
                        <td>{{ mit.expected_start }}</td>
                        <td>
                            <span style="background: #fed7aa; color: #9a3412; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">
                                {{ mit.status }}
                            </span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        <!-- MID-TRAINING SECTION -->
        {% if mits_by_week_band.weeks_4_5 %}
        <div class="section">
            <h2>üìö Mid-Training (Weeks 4-5)</h2>
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Week</th>
                        <th>Location</th>
                        <th>Vertical</th>
                        <th>Mentor Score</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for mit in mits_by_week_band.weeks_4_5 %}
                    <tr>
                        <td>{{ mit.name }}</td>
                        <td>{{ mit.week }}</td>
                        <td>{{ mit.location }}</td>
                        <td>{{ mit.vertical }}</td>
                        <td class="score {% if mit.mentor_score and mit.mentor_score >= 4.0 %}score-high{% elif mit.mentor_score and mit.mentor_score >= 3.0 %}score-mid{% elif mit.mentor_score %}score-low{% endif %}">
                            {% if mit.mentor_score %}{{ "%.1f"|format(mit.mentor_score) }}/5{% else %}‚Äî{% endif %}
                        </td>
                        <td>
                            <span class="status-badge {% if mit.readiness_status == 'Strong' %}status-strong{% elif mit.readiness_status == 'On Track' %}status-ontrack{% elif mit.readiness_status == 'Monitor' %}status-monitor{% else %}status-pending{% endif %}">
                                {{ mit.readiness_status }}
                            </span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        <!-- UPCOMING MOCK QBRs -->
        {% if upcoming_mock_qbrs %}
        <div class="section">
            <h2>üìÖ Upcoming Mock QBRs</h2>
            <div class="qbr-schedule">
                {% for qbr in upcoming_mock_qbrs %}
                <div class="qbr-item">
                    <strong>{{ qbr.date }}</strong> ‚Äî {{ qbr.name }} (Week {{ qbr.week }})
                </div>
                {% endfor %}
                </div>
        </div>
        {% endif %}

        <!-- KEY INSIGHTS -->
        <div class="section">
            <h2>üí° Key Insights</h2>
            <ul class="insights-list">
                {% for insight in performance_insights %}
                <li>{{ insight|safe }}</li>
                {% endfor %}
            </ul>
        </div>

        <!-- PLACEMENT READY - AVAILABLE FOR ASSIGNMENT -->
        {% if mits_by_week_band.weeks_8_plus %}
        <div class="section">
            <h2>‚úÖ Placement Ready ‚Äî Available for Assignment</h2>
            <p style="font-size: 12px; color: #64748b; margin-bottom: 15px;">MITs at Week 8+ who have completed training and are ready for immediate placement.</p>
            
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Week</th>
                        <th>Training Site</th>
                        <th>Location</th>
                        <th>Mentor</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for mit in mits_by_week_band.weeks_8_plus %}
                    <tr>
                        <td><strong>{{ mit.name }}</strong></td>
                        <td style="text-align: center;">{{ mit.week }}</td>
                        <td>{{ mit.location }}</td>
                        <td>{{ mit.vertical }}</td>
                        <td>{{ mit.mentor }}</td>
                        <td>
                            {% if mit.readiness_status == 'Strong' %}
                            <span style="background: #dcfce7; color: #166534; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">Ready</span>
                            {% elif mit.readiness_status == 'On Track' %}
                            <span style="background: #dbeafe; color: #1e40af; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">Ready</span>
                            {% else %}
                            <span style="background: #fef3c7; color: #92400e; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">{{ mit.status }}</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        <!-- CLIENT REQUESTS - MIT PLACEMENT PIPELINE -->
        {% if client_requests %}
        <div class="section">
            <h2>üéØ Client Requests ‚Äî MIT Placement Pipeline</h2>
            <p style="font-size: 12px; color: #64748b; margin-bottom: 15px;">
                <strong>{{ client_request_stats.total }}</strong> clients have specifically requested MIT placements. 
                Current supply: <strong>{{ band_counts.placement_ready }}</strong> MITs ready. 
                Gap: <strong style="color: {% if band_counts.placement_ready < client_request_stats.total %}#ef4444{% else %}#10b981{% endif %};">
                    {{ client_request_stats.total - band_counts.placement_ready }} additional MITs needed
                </strong>
            </p>
            
            <!-- Status Breakdown -->
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px;">
                <div style="background: #f0fdf4; padding: 15px; border-radius: 8px; border-left: 4px solid #10b981;">
                    <div style="font-size: 24px; font-weight: 700; color: #166534;">{{ client_request_stats.posted }}</div>
                    <div style="font-size: 11px; color: #15803d; text-transform: uppercase; font-weight: 600;">Posted & Recruiting</div>
                </div>
                <div style="background: #fef3c7; padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                    <div style="font-size: 24px; font-weight: 700; color: #92400e;">{{ client_request_stats.offer_extended }}</div>
                    <div style="font-size: 11px; color: #b45309; text-transform: uppercase; font-weight: 600;">Offers Extended</div>
                </div>
                <div style="background: #dbeafe; padding: 15px; border-radius: 8px; border-left: 4px solid #3b82f6;">
                    <div style="font-size: 24px; font-weight: 700; color: #1e40af;">{{ client_request_stats.pending_approval }}</div>
                    <div style="font-size: 11px; color: #1d4ed8; text-transform: uppercase; font-weight: 600;" title="Requested and moving through Recruiter/Comp/Finance/HR approvals before going live">Pending Posting</div>
                </div>
            </div>
            
            <!-- Top Clients & Managers -->
            {% if top_clients or top_managers %}
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                {% if top_clients %}
                <div>
                    <h3 style="font-size: 12px; color: #64748b; text-transform: uppercase; font-weight: 600; margin-bottom: 10px;">Top Requesting Clients</h3>
                    <ul style="list-style: none; padding: 0;">
                        {% for client, count in top_clients %}
                        <li style="padding: 8px 0; border-bottom: 1px solid #e2e8f0; font-size: 12px;">
                            <strong>{{ client }}</strong> <span style="color: #64748b;">({{ count }} role{% if count > 1 %}s{% endif %})</span>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
                
                {% if top_managers %}
                <div>
                    <h3 style="font-size: 12px; color: #64748b; text-transform: uppercase; font-weight: 600; margin-bottom: 10px;">Top Hiring Managers</h3>
                    <ul style="list-style: none; padding: 0;">
                        {% for manager, count in top_managers %}
                        <li style="padding: 8px 0; border-bottom: 1px solid #e2e8f0; font-size: 12px;">
                            <strong>{{ manager }}</strong> <span style="color: #64748b;">({{ count }} role{% if count > 1 %}s{% endif %})</span>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>
            {% endif %}
            
            <!-- All Requests Table -->
            <h3 style="font-size: 12px; color: #475569; margin-bottom: 12px; font-weight: 600;">All Client Requests</h3>
            <table>
                <thead>
                    <tr>
                        <th>Client</th>
                        <th>Location</th>
                        <th>Hiring Manager</th>
                        <th>Status</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    {% for req in client_requests %}
                    <tr>
                        <td><strong>{{ req.client }}</strong></td>
                        <td>{{ req.location }}</td>
                        <td>{{ req.hiring_manager }}</td>
                        <td>
                            {% if 'posted' in req.status.lower() %}
                            <span style="background: #dcfce7; color: #166534; padding: 4px 10px; border-radius: 12px; font-size: 10px; font-weight: 600;">{{ req.status }}</span>
                            {% elif 'offer' in req.status.lower() or 'extended' in req.status.lower() %}
                            <span style="background: #fef3c7; color: #92400e; padding: 4px 10px; border-radius: 12px; font-size: 10px; font-weight: 600;">{{ req.status }}</span>
                            {% elif 'pending' in req.status.lower() %}
                            <span style="background: #dbeafe; color: #1e40af; padding: 4px 10px; border-radius: 12px; font-size: 10px; font-weight: 600;">{{ req.status }}</span>
                            {% else %}
                            <span style="background: #f1f5f9; color: #475569; padding: 4px 10px; border-radius: 12px; font-size: 10px; font-weight: 600;">{{ req.status }}</span>
                            {% endif %}
                        </td>
                        <td style="font-size: 11px; color: #64748b;">{{ req.notes if req.notes else '‚Äî' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        <!-- LATEST MIT SURVEY RESULTS -->
        {% if assessment_data %}
        <div class="section" style="page-break-inside: avoid;">
            <h2>üìä Latest MIT Survey Results ‚Äî 1/27/2026</h2>
            <p style="font-size: 12px; color: #64748b; margin-bottom: 20px;">
                Most recent mentor assessments across Core Competencies, Soft Skills, Engagement, and Readiness.
            </p>
            
            {% set target_names = ['zimri quintero moreno', 'traci thomson', 'juvae randolph', 'orlando doss', 'juan hernandez', 'eddie bennett', 'humberto sanchez'] %}
            {% set ns = namespace(latest_surveys=[]) %}
            {% for target in target_names %}
                {% for mit in assessment_data %}
                    {% if mit['name']|lower == target %}
                        {% set _ = ns.latest_surveys.append(mit) %}
                    {% endif %}
                {% endfor %}
            {% endfor %}
            
            {% if ns.latest_surveys %}
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; margin-bottom: 20px;">
                {% for mit in ns.latest_surveys %}
                <div style="background: {% if mit['overall'] >= 4.5 %}#f0fdf4{% elif mit['overall'] >= 4.0 %}#fef3c7{% else %}#fef2f2{% endif %}; 
                           padding: 20px; border-radius: 12px; 
                           border-left: 4px solid {% if mit['overall'] >= 4.5 %}#10b981{% elif mit['overall'] >= 4.0 %}#f59e0b{% else %}#ef4444{% endif %};">
                    <div style="font-size: 16px; font-weight: 700; color: #1e293b; margin-bottom: 12px;">{{ mit['name'] }}</div>
                    
                    <!-- Overall Score -->
                    <div style="display: flex; align-items: center; margin-bottom: 15px;">
                        <div style="font-size: 32px; font-weight: 700; 
                                   color: {% if mit['overall'] >= 4.5 %}#059669{% elif mit['overall'] >= 4.0 %}#d97706{% else %}#dc2626{% endif %};">
                            {{ "%.1f"|format(mit['overall']) }}
                        </div>
                        <div style="margin-left: 10px;">
                            <div style="font-size: 11px; color: #64748b; text-transform: uppercase; font-weight: 600;">Overall Score</div>
                            <div style="font-size: 10px; color: #94a3b8;">out of 5.0</div>
                        </div>
                    </div>
                    
                    <!-- Section Breakdown -->
                    <div style="background: rgba(255,255,255,0.7); padding: 12px; border-radius: 8px; margin-bottom: 12px;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 11px;">
                            <div>
                                <span style="color: #64748b;">Core Competencies:</span>
                                <strong style="color: #1e293b; margin-left: 4px;">{{ "%.1f"|format(mit['section_1']) }}</strong>
                            </div>
                            <div>
                                <span style="color: #64748b;">Soft Skills:</span>
                                <strong style="color: #1e293b; margin-left: 4px;">{{ "%.1f"|format(mit['section_2']) }}</strong>
                            </div>
                            <div>
                                <span style="color: #64748b;">Engagement:</span>
                                <strong style="color: #1e293b; margin-left: 4px;">{{ "%.1f"|format(mit['section_3']) }}</strong>
                            </div>
                            <div>
                                <span style="color: #64748b;">Readiness:</span>
                                <strong style="color: #1e293b; margin-left: 4px;">{{ "%.1f"|format(mit['section_4']) }}</strong>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Performance Status -->
                    <div style="font-size: 10px; color: #64748b; text-transform: uppercase; margin-bottom: 4px; font-weight: 600;">Status</div>
                    <div style="margin-bottom: 12px;">
                        <span style="background: {% if mit['overall'] >= 4.5 %}#dcfce7{% elif mit['overall'] >= 4.0 %}#fef3c7{% else %}#fee2e2{% endif %}; 
                                     color: {% if mit['overall'] >= 4.5 %}#166534{% elif mit['overall'] >= 4.0 %}#92400e{% else %}#991b1b{% endif %}; 
                                     padding: 6px 12px; border-radius: 12px; font-size: 11px; font-weight: 600;">
                            {% if mit['overall'] >= 4.5 %}‚úÖ Exceeding Expectations{% elif mit['overall'] >= 4.0 %}‚úÖ Progressing as Expected{% else %}‚ö†Ô∏è Needs Support{% endif %}
                        </span>
                    </div>
                    
                    <!-- Observations -->
                    {% if mit['observations'] and mit['observations'].strip() %}
                    <div style="font-size: 10px; color: #64748b; text-transform: uppercase; margin-bottom: 4px; font-weight: 600;">Mentor Notes</div>
                    <div style="font-size: 11px; color: #475569; line-height: 1.5; font-style: italic; background: rgba(255,255,255,0.5); padding: 10px; border-radius: 6px;">
                        "{{ mit['observations'] }}"
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            
            <!-- Full Survey Breakdown Table -->
            <h3 style="font-size: 12px; color: #475569; margin-top: 20px; margin-bottom: 12px; font-weight: 600;">Detailed Score Breakdown</h3>
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Overall</th>
                        <th>Core Competencies</th>
                        <th>Soft Skills</th>
                        <th>Engagement</th>
                        <th>Readiness</th>
                    </tr>
                </thead>
                <tbody>
                    {% for mit in ns.latest_surveys %}
                    <tr style="background: {% if mit['overall'] >= 4.5 %}#f0fdf4{% elif mit['overall'] >= 4.0 %}#fefce8{% else %}#fef2f2{% endif %};">
                        <td><strong>{{ mit['name'] }}</strong></td>
                        <td class="score" style="font-weight: 700; 
                                              color: {% if mit['overall'] >= 4.5 %}#059669{% elif mit['overall'] >= 4.0 %}#ca8a04{% else %}#dc2626{% endif %};">
                            {{ "%.2f"|format(mit['overall']) }}
                        </td>
                        <td>{{ "%.1f"|format(mit['section_1']) }}</td>
                        <td>{{ "%.1f"|format(mit['section_2']) }}</td>
                        <td>{{ "%.1f"|format(mit['section_3']) }}</td>
                        <td>{{ "%.1f"|format(mit['section_4']) }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p style="color: #94a3b8; font-style: italic;">No recent survey data available.</p>
            {% endif %}
        </div>
        {% endif %}

        <!-- DEVELOPMENT FOCUS - HIDDEN (Old Batch Data) -->
        {% if False and bottom_2_mits %}
        <div class="section">
            <h2>üìà Development Focus</h2>
            
            <!-- Mentor Assessment Scores Table -->
            <h3 style="font-size: 12pt; color: #475569; margin-top: 0; margin-bottom: 12px; font-weight: 600;">Mentor Assessment Scores</h3>
            <table style="margin-bottom: 20px;">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Overall</th>
                        <th>Core</th>
                        <th>Soft Skills</th>
                        <th>Engagement</th>
                        <th>Readiness</th>
                    </tr>
                </thead>
                <tbody>
                    {% for mit in bottom_2_mits %}
                    <tr>
                        <td><strong>{{ mit.name }}</strong></td>
                        <td class="score score-mid">{{ "%.2f"|format(mit.overall) }}</td>
                        <td>{{ "%.1f"|format(mit.section_1) }}</td>
                        <td>{{ "%.1f"|format(mit.section_2) }}</td>
                        <td>{{ "%.1f"|format(mit.section_3) }}</td>
                        <td>{{ "%.1f"|format(mit.section_4) }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            
            <!-- Performance Snapshot Scores Table -->
            <h3 style="font-size: 12pt; color: #475569; margin-top: 20px; margin-bottom: 12px; font-weight: 600;">Performance Snapshot Scores</h3>
            <table style="margin-bottom: 20px;">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Assessment</th>
                        <th>Confidence</th>
                        <th>Perf Eval</th>
                        <th>Skill Ranking</th>
                        <th>Mock QBR</th>
                    </tr>
                </thead>
                <tbody>
                    {% for mit in bottom_2_mits %}
                    {% set is_evan_or_lloyd = (mit.name.lower() | replace("'", "") | replace("-", " ") == "evan tichenor") or (mit.name.lower() | replace("'", "") | replace("-", " ") == "lloyd harrison hine") %}
                    <tr {% if is_evan_or_lloyd %}style="background: #fef3c7; border-left: 4px solid #f59e0b;"{% endif %}>
                        <td><strong>{{ mit.name }}</strong>{% if is_evan_or_lloyd %} <span style="color: #92400e; font-size: 10pt; font-weight: 600;">‚ö†Ô∏è</span>{% endif %}</td>
                        <td>
                            {% if mit.assessment_score and mit.assessment_score > 0 %}
                                {{ "%.0f"|format(mit.assessment_score) }}/100
                            {% else %}
                                <span style="color: #94a3b8;">TBD</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if mit.confidence_score and mit.confidence_score > 0 %}
                                <span style="{% if mit.confidence_score < 50 %}color: #ef4444; font-weight: 600;{% elif mit.confidence_score < 70 %}color: #f59e0b;{% else %}color: #10b981;{% endif %}">
                                    {{ "%.0f"|format(mit.confidence_score) }}/100
                                </span>
                            {% else %}
                                <span style="color: #94a3b8;">TBD</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if mit.perf_eval_score and mit.perf_eval_score > 0 %}
                                {{ "%.0f"|format(mit.perf_eval_score) }}/60
                            {% else %}
                                <span style="color: #94a3b8;">TBD</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if mit.skill_ranking and mit.skill_ranking != 'TBD' and mit.skill_ranking != '' %}
                                <span style="{% if 'low' in mit.skill_ranking.lower() %}color: #ef4444; font-weight: 600;{% elif 'mid' in mit.skill_ranking.lower() %}color: #f59e0b;{% else %}color: #10b981;{% endif %}">
                                    {{ mit.skill_ranking }}
                                </span>
                            {% else %}
                                <span style="color: #94a3b8;">TBD</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if mit.mock_qbr_score and mit.mock_qbr_score > 0 %}
                                <span style="{% if mit.mock_qbr_score < 2 %}color: #ef4444; font-weight: 600;{% elif mit.mock_qbr_score < 3 %}color: #f59e0b;{% else %}color: #10b981;{% endif %}">
                                    {{ "%.1f"|format(mit.mock_qbr_score) }}/4
                                </span>
                            {% else %}
                                <span style="color: #94a3b8;">TBD</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            
            <!-- Mentor Feedback -->
            {% for mit in bottom_2_mits %}
                {% if mit.observations and mit.observations.strip() %}
                <div style="margin-top: 15px; padding: 12px; background: #f8fafc; border-left: 3px solid #f59e0b; border-radius: 6px;">
                    <div style="font-size: 11px; color: #64748b; text-transform: uppercase; font-weight: 600; margin-bottom: 6px;">{{ mit.name }} ‚Äî Latest Mentor Feedback</div>
                    <div style="font-size: 12px; color: #475569; line-height: 1.5; font-style: italic;">"{{ mit.observations }}"</div>
                </div>
                {% endif %}
            {% endfor %}
        </div>
        {% endif %}

        <!-- MEETING INSIGHTS - HIDDEN (Old Information) -->
        {% if False and meeting_insights %}
        <div class="section">
            <h2>üìã Prior Meeting Notes</h2>
            <ul class="meeting-insights">
                {% for insight in meeting_insights %}
                <li>{{ insight }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        <!-- JOB OPENINGS BY REGION - HIDDEN (Not Needed on Exec Report) -->
        {% if False and positions_by_region %}
        <div class="section">
            <h2>üíº Job Openings by Region</h2>
            
            <!-- Summary Statistics Box -->
            {% if job_openings_stats %}
            <div style="background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); padding: 24px; border-radius: 10px; margin-bottom: 30px; border-left: 5px solid #3b82f6; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 24px; margin-bottom: 20px;">
                    <div style="text-align: center;">
                        <div style="font-size: 32px; font-weight: 700; color: #1e293b; margin-bottom: 6px;">{{ job_openings_stats.total_positions }}</div>
                        <div style="font-size: 11px; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">Total Positions</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 32px; font-weight: 700; color: #10b981; margin-bottom: 6px;">
                            {% if job_openings_stats.avg_salary > 0 %}
                                ${{ "{:,.0f}".format(job_openings_stats.avg_salary) }}
                            {% else %}
                                N/A
                            {% endif %}
                        </div>
                        <div style="font-size: 11px; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">Average Salary</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 32px; font-weight: 700; color: #3b82f6; margin-bottom: 6px;">{{ job_openings_stats.total_regions }}</div>
                        <div style="font-size: 11px; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">Regions</div>
                    </div>
                    {% if job_openings_stats.top_verticals %}
                    <div style="text-align: center;">
                        <div style="font-size: 18px; font-weight: 600; color: #6366f1; margin-bottom: 6px;">
                            {{ job_openings_stats.top_verticals[0][0] if job_openings_stats.top_verticals else 'N/A' }}
                        </div>
                        <div style="font-size: 11px; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">Top Vertical</div>
                    </div>
                    {% endif %}
                </div>
                
                <!-- Top Verticals Breakdown -->
                {% if job_openings_stats.top_verticals %}
                <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #e2e8f0;">
                    <div style="font-size: 12px; color: #475569; font-weight: 600; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.5px;">Top Verticals by Position Count</div>
                    <div style="display: flex; gap: 16px; flex-wrap: wrap;">
                        {% for vertical, count in job_openings_stats.top_verticals %}
                        <div style="background: white; padding: 10px 16px; border-radius: 6px; border: 1px solid #e2e8f0; flex: 1; min-width: 120px;">
                            <div style="font-size: 20px; font-weight: 700; color: #1e293b;">{{ count }}</div>
                            <div style="font-size: 11px; color: #64748b; margin-top: 4px;">{{ vertical }}</div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
            {% endif %}
            
            <!-- Regional Tables (sorted by salary, highest first) -->
            {% for region, positions in positions_by_region.items() %}
            <div style="margin-bottom: 35px;">
                <h3 style="font-size: 15pt; color: #1e293b; margin-bottom: 14px; padding-bottom: 10px; border-bottom: 3px solid #3b82f6; font-weight: 600;">
                    {{ region }} <span style="color: #64748b; font-weight: 500; font-size: 13pt;">({{ positions|length }} position{{ 's' if positions|length != 1 else '' }})</span>
                </h3>
                <table style="width: 100%; margin-bottom: 20px; border-collapse: collapse;">
                    <thead>
                        <tr style="background: #f8fafc;">
                            <th style="text-align: left; padding: 12px; border-bottom: 2px solid #e2e8f0; font-weight: 600; color: #475569; font-size: 11pt;">Job Title</th>
                            <th style="text-align: left; padding: 12px; border-bottom: 2px solid #e2e8f0; font-weight: 600; color: #475569; font-size: 11pt;">Account</th>
                            <th style="text-align: left; padding: 12px; border-bottom: 2px solid #e2e8f0; font-weight: 600; color: #475569; font-size: 11pt;">Location</th>
                            <th style="text-align: left; padding: 12px; border-bottom: 2px solid #e2e8f0; font-weight: 600; color: #475569; font-size: 11pt;">Vertical</th>
                            <th style="text-align: right; padding: 12px; border-bottom: 2px solid #e2e8f0; font-weight: 600; color: #475569; font-size: 11pt;">Salary</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for position in positions %}
                        {% set salary_val = position.salary if position.salary is number else 0 %}
                        {% if salary_val >= 80000 %}
                            {% set row_bg = '#f0fdf4' %}
                            {% set salary_color = '#10b981' %}
                        {% elif salary_val >= 60000 %}
                            {% set row_bg = '#fffbeb' %}
                            {% set salary_color = '#f59e0b' %}
                        {% else %}
                            {% set row_bg = '#ffffff' %}
                            {% set salary_color = '#64748b' %}
                        {% endif %}
                        <tr style="border-bottom: 1px solid #f1f5f9; background: {{ row_bg }};">
                            <td style="padding: 12px; color: #334155; font-weight: 500; font-size: 11pt;">{{ position.title }}</td>
                            <td style="padding: 12px; color: #64748b; font-size: 11pt;">{{ position.account }}</td>
                            <td style="padding: 12px; color: #64748b; font-size: 11pt;">{{ position.city }}{% if position.state %}, {{ position.state }}{% endif %}</td>
                            <td style="padding: 12px; color: #64748b; font-size: 11pt;">{{ position.vertical }}</td>
                            <td style="padding: 12px; text-align: right; font-weight: 600; font-size: 11pt; color: {{ salary_color }};">
                                {% if position.salary %}
                                    {% if position.salary is string %}
                                        {{ position.salary }}
                                    {% else %}
                                        ${{ "{:,.0f}".format(position.salary) }}
                                    {% endif %}
                                {% else %}
                                    <span style="color: #94a3b8;">TBD</span>
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <!-- APPENDIX: Complete MIT Roster -->
        <div class="section">
            <h2>üìë Appendix: Complete MIT Roster</h2>
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Vertical</th>
                        <th>Week</th>
                        <th>Location</th>
                        <th>Mentor</th>
                        <th>Status</th>
                        <th>Scores</th>
                    </tr>
                </thead>
                <tbody>
                    {% for mit in all_mits %}
                    <tr>
                        <td>{{ mit.name }}</td>
                        <td>{{ mit.vertical }}</td>
                        <td>{{ mit.week }}</td>
                        <td>{{ mit.location }}</td>
                        <td>{{ mit.mentor }}</td>
                        <td>{{ mit.status }}</td>
                        <td>{{ mit.scores }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>Full dashboard: <a href="{{ dashboard_url }}" target="_blank">{{ dashboard_url }}</a></p>
        </div>
    </div>
</body>
</html>
